<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/afd2902bef.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="login.css">
    <title>Login form</title>
</head>
<body>
    <div class="container">
        <div class="wrapper">
            <form method="post" id="loginForm">
                <header>
                    <h1>Sign In</h1>
                </header>
                <p><input type="text"  placeholder="E-mail" id="email"></p>
                <p><input type="password"  placeholder="Password" id="password"></p>
                <p><button type="submit">Login</button></p>
                <p>Not registered <a href="index.html"> create account</a></p>
            </form>
        
            <script>
                document.getElementById('loginForm').addEventListener('submit', async function(event) {
                    event.preventDefault(); // Prevent the default form submission
        
                    const email = document.getElementById('email').value;
                    const password = document.getElementById('password').value;
        
                    try {
                        const response = await fetch('https://project-restapi.onrender.com/api/v1/auth/login', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ email: email, password: password })
                        });
        
                        const result = await response.json();
                        if (response.ok) {
                           (function redirectToPage() {
                              alert("login sucessful")
                              window.location.href = "package.html";
                          })();} 
                        else {
                      alert(result.err) }} 
                      catch (error) {
                        console.error('Error:', error);
                    }
                });
            </script>
        </body>
        </html>